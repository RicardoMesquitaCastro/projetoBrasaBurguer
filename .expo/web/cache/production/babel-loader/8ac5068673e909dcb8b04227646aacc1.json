{"ast":null,"code":"import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}import NativeModules from\"react-native-web/dist/exports/NativeModules\";var NativeGraphRequestManager=NativeModules.FBGraphRequest;function _verifyParameters(request){var _request$config;if((_request$config=request.config)!==null&&_request$config!==void 0&&_request$config.parameters){for(var key in request.config.parameters){var param=request.config.parameters[key];if(typeof param==='object'&&param!==null&&param!==void 0&&param.string){continue;}throw new Error(\"Unexpected value for parameter '\"+key+\"'. Request parameters \"+\"need to be objects with a 'string' field.\");}}}var FBGraphRequestManager=function(){function FBGraphRequestManager(){_classCallCheck(this,FBGraphRequestManager);_defineProperty(this,\"requestBatch\",[]);_defineProperty(this,\"requestCallbacks\",[]);_defineProperty(this,\"batchCallback\",null);}_createClass(FBGraphRequestManager,[{key:\"addRequest\",value:function addRequest(request){_verifyParameters(request);this.requestBatch.push(request);this.requestCallbacks.push(request.callback);return this;}},{key:\"addBatchCallback\",value:function addBatchCallback(callback){this.batchCallback=callback;return this;}},{key:\"start\",value:function start(timeout){var that=this;var callback=function callback(error,result,response){if(response){that.requestCallbacks.forEach(function(innerCallback,index){if(innerCallback){innerCallback(response[index][0],response[index][1]);}});}if(that.batchCallback){that.batchCallback(error,result);}};NativeGraphRequestManager.start(this.requestBatch,timeout||0,callback);}}]);return FBGraphRequestManager;}();export default FBGraphRequestManager;","map":{"version":3,"sources":["FBGraphRequestManager.ts"],"names":["NativeGraphRequestManager","NativeModules","request","param","addRequest","_verifyParameters","addBatchCallback","start","that","callback","innerCallback","response","timeout"],"mappings":"6XAwBA,GAAMA,CAAAA,yBAAyB,CAAGC,aAAa,CAA/C,cAAA,CAOA,QAAA,CAAA,iBAAA,CAAA,OAAA,CAAkD,CAAA,GAAA,CAAA,eAAA,CAChD,GAAA,CAAA,eAAA,CAAIC,OAAO,CAAX,MAAA,IAAA,IAAA,EAAA,eAAA,GAAA,IAAA,EAAA,EAAIA,eAAAA,CAAJ,UAAA,CAAgC,CAC9B,IAAK,GAAL,CAAA,GAAA,GAAkBA,CAAAA,OAAO,CAAPA,MAAAA,CAAlB,UAAA,CAA6C,CAC3C,GAAMC,CAAAA,KAAK,CAAGD,OAAO,CAAPA,MAAAA,CAAAA,UAAAA,CAAd,GAAcA,CAAd,CAEA,GACE,MAAA,CAAA,KAAA,GAAA,QAAA,EACCC,KADD,GAAA,IAAA,EACCA,KADD,GAAA,IAAA,EAAA,EACCA,KAAD,CAFF,MAAA,CAGE,CACA,SACD,CACD,KAAM,IAAA,CAAA,KAAA,CACJ,mCAAA,GAAA,CAAA,wBAAA,CADF,2CAAM,CAAN,CAMD,CACF,CACF,C,GAED,CAAA,qB,YAA4B,gCAAA,6CAAA,eAAA,CAAA,IAAA,CAAA,cAAA,CAAA,EAAA,CAAA,CAAA,eAAA,CAAA,IAAA,CAAA,kBAAA,CAAA,EAAA,CAAA,CAAA,eAAA,CAAA,IAAA,CAAA,eAAA,CAAA,IAAA,CAAA,CAAA,C,4DAQ1BC,oBAAU,OAAVA,CAAyD,CACvDC,iBAAiB,CAAjBA,OAAiB,CAAjBA,CACA,KAAA,YAAA,CAAA,IAAA,CAAA,OAAA,EACA,KAAA,gBAAA,CAAA,IAAA,CAA2BH,OAAO,CAAlC,QAAA,EACA,MAAA,KAAA,CACD,C,gCAODI,0BAAgB,QAAhBA,CAKyB,CACvB,KAAA,aAAA,CAAA,QAAA,CACA,MAAA,KAAA,CACD,C,qBAYDC,eAAK,OAALA,CAAwB,CAEtB,GAAMC,CAAAA,IAAI,CAAV,IAAA,CACA,GAAMC,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAAA,KAAA,CAAA,MAAA,CAAA,QAAA,CAIZ,CACH,GAAA,QAAA,CAAc,CACZD,IAAI,CAAJA,gBAAAA,CAAAA,OAAAA,CAA8B,SAAA,aAAA,CAAA,KAAA,CAA0B,CACtD,GAAA,aAAA,CAAmB,CACjBE,aAAa,CAACC,QAAQ,CAARA,KAAQ,CAARA,CAAD,CAACA,CAAD,CAAqBA,QAAQ,CAARA,KAAQ,CAARA,CAAlCD,CAAkCC,CAArB,CAAbD,CACD,CAHHF,CAAAA,EAKD,CACD,GAAIA,IAAI,CAAR,aAAA,CAAwB,CACtBA,IAAI,CAAJA,aAAAA,CAAAA,KAAAA,CAAAA,MAAAA,EACD,CAdH,CAAA,CAiBAR,yBAAyB,CAAzBA,KAAAA,CAAgC,KAAhCA,YAAAA,CAAmDY,OAAO,EAA1DZ,CAAAA,CAAAA,QAAAA,EACD,C,qCAGH,cAAA,CAAA,qBAAA","sourcesContent":["/**\n * Copyright (c) 2015-present, Facebook, Inc. All rights reserved.\n *\n * You are hereby granted a non-exclusive, worldwide, royalty-free license to use,\n * copy, modify, and distribute this software in source code or binary form for use\n * in connection with the web services and APIs provided by Facebook.\n *\n * As with any software that integrates with the Facebook platform, your use of\n * this software is subject to the Facebook Developer Principles and Policies\n * [http://developers.facebook.com/policy/]. This copyright notice shall be\n * included in all copies or substantial portions of the software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n *\n * @format\n */\nimport GraphRequest, {GraphRequestParameters} from './FBGraphRequest';\nimport {NativeModules} from 'react-native';\n\nconst NativeGraphRequestManager = NativeModules.FBGraphRequest;\n\nexport type Callback = (\n  error?: Record<string, unknown>,\n  result?: Record<string, unknown>,\n) => void;\n\nfunction _verifyParameters(request: GraphRequest) {\n  if (request.config?.parameters) {\n    for (const key in request.config.parameters) {\n      const param = request.config.parameters[key];\n\n      if (\n        typeof param === 'object' &&\n        (param as GraphRequestParameters)?.string\n      ) {\n        continue;\n      }\n      throw new Error(\n        \"Unexpected value for parameter '\" +\n          key +\n          \"'. Request parameters \" +\n          \"need to be objects with a 'string' field.\",\n      );\n    }\n  }\n}\n\nclass FBGraphRequestManager {\n  requestBatch: Array<GraphRequest> = [];\n  requestCallbacks: Array<Callback | undefined> = [];\n  batchCallback: Callback | null = null;\n\n  /**\n   * Add a graph request.\n   */\n  addRequest(request: GraphRequest): FBGraphRequestManager {\n    _verifyParameters(request);\n    this.requestBatch.push(request);\n    this.requestCallbacks.push(request.callback);\n    return this;\n  }\n\n  /**\n   * Add call back to the GraphRequestManager. Only one callback can be added.\n   * Note that invocation of the batch callback does not indicate success of every\n   * graph request made, only that the entire batch has finished executing.\n   */\n  addBatchCallback(\n    callback: (\n      error?: Record<string, unknown>,\n      result?: Record<string, unknown>,\n    ) => void,\n  ): FBGraphRequestManager {\n    this.batchCallback = callback;\n    return this;\n  }\n\n  /**\n   * Executes requests in a batch.\n   * Note that when there's an issue with network connection the batch callback\n   * behavior differs in Android and iOS.\n   * On iOS, the batch callback returns an error if the batch fails with a network error.\n   * On Android, the batch callback always returns {\"result\": \"batch finished executing\"}\n   * after the batch time out. This is because detecting network status requires\n   * extra permission and it's unncessary for the sdk. Instead, you can use the NetInfo module\n   * in react-native to get the network status.\n   */\n  start(timeout?: number) {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const that = this;\n    const callback = (\n      error: Record<string, unknown>,\n      result: Record<string, unknown>,\n      response: Array<Array<Record<string, unknown>>>,\n    ) => {\n      if (response) {\n        that.requestCallbacks.forEach((innerCallback, index) => {\n          if (innerCallback) {\n            innerCallback(response[index][0], response[index][1]);\n          }\n        });\n      }\n      if (that.batchCallback) {\n        that.batchCallback(error, result);\n      }\n    };\n\n    NativeGraphRequestManager.start(this.requestBatch, timeout || 0, callback);\n  }\n}\n\nexport default FBGraphRequestManager;\n"]},"metadata":{},"sourceType":"module"}